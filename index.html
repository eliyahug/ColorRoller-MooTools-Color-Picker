<!doctype html>
<html>
<head>
	<title>ColorRoller</title>
	<script type="text/javascript" src="../jslibs/moo.124.js"></script>
	<script type="text/javascript" src="../jslibs/Drag.1242.js"></script>
	<script type="text/javascript" src="scripts/Color.js"></script>
	<link 	type="text/css" rel="stylesheet" href="scripts/colorroller.css">
	<style type="text/css">
		body{
			border:0; 
			margin:0;
		}
		
	</style>
	<script type="text/javascript">
		

		window.addEvent('load', function init(){
			$$('.ColorRoller').each(function(CR){
				var g,
					hueCursor = CR.getElement('.hueCursor'),
					huePicker = CR.getElement('.huePicker'),
					hueHeight = huePicker.getSize().y,
					colorView = CR.getElement('.colorView'),
					colorHex = CR.getElement('.colorHex'),
					colorCursor = CR.getElement('.colorCursor'),
					colorPicker = CR.getElement('.colorPicker'),
					colorHeight = colorPicker.getSize().x,
					radius = colorHeight / 2,
					cR = CR.getElement('.colorR'),
					cG = CR.getElement('.colorG'),
					cB = CR.getElement('.colorB'),
					cH = CR.getElement('.colorH'),
					cS = CR.getElement('.colorS'),
					cV = CR.getElement('.colorV'),
					cS = CR.getElement('.colorSpace'),
					cX = CR.getElement('.colorHex');
				
				function greyarea(cursor){
					g = 100 - hueCursor.getPosition(huePicker).y / hueHeight * 100;
					var	n = (g * 2.5).toString(16);
					colorPicker.setStyle('background-color', '#'+n+n+n);
					cV.set('value',g);
					colorpick();
				}
				function colorSpace(){
					cS.set('text','B');
				}
				function colorpick(){
					var pos = colorCursor.getPosition(colorPicker),
						x = pos.x - radius,
						y = radius - pos.y,
						h = Math.atan2(x,y) / Math.PI * 180,
						s = Math.sqrt(x*x+y*y) / radius * 100;
						
						if (h < 0) h -= -360;
						var rgb = [h,s,g].toRgb('hsg');
						
						cR.set('value',rgb[0]);
						cG.set('value',rgb[1]);
						cB.set('value',rgb[2]);
						cH.set('value',h);
						cS.set('value',Math.round(s));
						cX.set('value',rgb.rgbToHex());
						colorView.setStyle('background-color','rgb('+rgb+')');
				}
				greyarea();
				new Drag(colorCursor, {
					snap: 0,
					limit: {x:0,y:0},
					onDrag: colorpick
				});
				new Drag(hueCursor, {
					snap: 0,
					limit: {x:[0,0],y:[0,hueHeight]},
					onDrag: greyarea
				});
			});
		});
		
		/*	
		*	// The atan2 function is supposed to take y before x, and assume 0" is at the 9:00 position.
		*	// To use it as intended: turn image 90". change the 180 to -180.
		*						
		*	radius = colorHeight / 2,
		*	x = pos.x - radius, 
		*	y = pos.y - radius, 
		*			
		*	for (var i=0;i<3;i++) c[i] = (((Math.abs((hue+=2)%6 - 3) < 1 ? 1 : hue > 2 ? 0 : -(hue-2)) - brightness) * saturation + brightness) * 255;  
		*	return hex = [c[0],c[2],c[1]].rgbToHex();
		*		
		*	c[i] = ((hue - brightness) * saturation + brightness) * 255;  hue=angle of ColorWheel.  saturation =percent of radius, brightness = scrollWheel.
		*	for(i=0;i<3;i++) c[i] = ((((h=Math.abs(++hue)) < 1 ? 1 : h > 2 ? 0 : -(h-2)) - brightness) * saturation + brightness) * 255;  
		*	c[1] = -(c[2] - 255*saturation);var hex = c.rgbToHex();
		*	var c, radius = this.getSize().x/2, x = mouse.x - radius, y = mouse.y - radius, brightness = hue.y / hue.getSize().y, hue = Math.atan2(x,y)/Math.PI * 3 - 2, saturation = Math.sqrt(x*x+y*y) / radius;
		*/
	</script>
</head>
<body>
	<div class="ColorRoller">
		<div class="pickerHeader">
			ColorRoller
		</div>
		<div class="colorPicker">
			<img src="images/Transp.png">
			<div class="colorCursor"><div></div></div>
		</div>
		<div class="huePicker">
			<div class="hueCursor"></div>
		</div>
		<div class="amts">
			<select>
				<option value="G">HSG</option>
				<option value="B">HSB/V</option>
				<option value="L">HSL/I</option>
			</select>
			<select>
				<option>Color - Wheel</option>
				<option>Color - Square</option>
				<option>Grey - Stretched</option>
				<option>Grey - Literal</option>
				<option>MooRTE</option>
			</select>
			<div class="colorText">
				<span>R</span><input class="colorR">
				<span>G</span><input class="colorG">
				<span>B</span><input class="colorB">
			</div>
			<div class="colorText">
				<span>H</span><input class="colorH">
				<span>S</span><input class="colorS">
				<span class="colorSpace">V</span><input class="colorV">
			</div>
			<div  class="colorText">
				Hex<input class="colorHex" style="width:50px;">
				<span class="colorView" style="height:10px; width:30px; display:inline-block"></span>
			</div>
		</div>
	</div>
	<!--
	<div id="colors"></div>
	<div class="p2"></div>
	-->
</body>
</html>